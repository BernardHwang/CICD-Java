pipeline { 
    agent any 
    stages { 
        stage('Checkout') { 
            steps { 
                git branch: 'main', url: 'https://github.com/BernardHwang/CICD-Java.git' 
                sh 'chmod +x gradlew' 
                sh 'chmod +x /usr/bin/docker'
            } 
        } 
        stage('Build + Test + Deploy') { 
            parallel {
                stage('Build') {
                    steps { sh './gradlew build'} 
                }
                 stage('Test') { 
                    steps { sh './gradlew test'}  
                } 
                stage('Deploy') { 
                    steps {  
                        sh 'docker build -t cicd-java:1st .' 
                    }            
                }   
            }
        } 
    } 
}